<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario de Registro - GPE</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #0d47a1; 
            --secondary-color: #1565c0;
            --title-color: #2980b9; /* Color unificado para títulos */
            --light-blue-bg: #e3f2fd;
            --light-gray: #f4f7f6;
            --text-color: #333;
            --border-color: #ccc;
            --success-color: #28a745;
            --error-color: #dc3545;
        }
        body {
            font-family: 'Poppins', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(to right bottom, #f0f4f8, #ffffff);
            color: var(--text-color);
        }
        
        /* --- AJUSTE DE CABECERA --- */
        .header-banner {
            background-color: var(--primary-color);
            padding: 15px 20px;
            display: flex;
            justify-content: center; /* Centra el contenido de la cabecera */
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .header-content {
            display: flex;
            align-items: center;
            gap: 20px; /* Espacio entre el logo y el título */
            flex-wrap: wrap; /* Permite que el texto se ajuste en pantallas pequeñas */
            justify-content: center; /* Centra en caso de ajuste de línea */
        }
        .header-banner img {
            max-height: 110px;
        }
        .header-banner h1 {
            color: #ffffff; 
            font-size: 1.8em;
            margin: 0; /* Resetea el margen para un mejor alineamiento */
            border: none;
            padding: 0;
            text-align: center;
        }
        @media (max-width: 600px) {
            .header-banner h1 {
                font-size: 1.4em;
            }
        }
        /* --- FIN DE AJUSTE DE CABECERA --- */

        .container {
            max-width: 800px;
            margin: 25px auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .container > h2, #capacitaciones-title, #auditores-title {
            text-align: center;
            border-bottom: none;
            margin-bottom: 5px;
            font-size: 1.8em;
            color: var(--title-color); 
        }
        .form-description {
            font-size: 0.9em;
            text-align: center;
            background-color: var(--light-blue-bg);
            padding: 12px;
            border-radius: 6px;
            margin: 10px auto 25px;
            border-left: 4px solid var(--secondary-color);
            color: var(--primary-color);
            max-width: 95%;
            line-height: 1.5;
        }
        h2, h3, h4 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--light-gray);
            padding-bottom: 10px;
        }
        hr.section-divider {
            border: 0;
            height: 1px;
            background-image: linear-gradient(to right, rgba(0, 0, 0, 0), var(--secondary-color), rgba(0, 0, 0, 0));
            margin: 30px 0;
        }
        form { display: grid; grid-template-columns: 1fr; gap: 20px; }
        @media (min-width: 768px) { form { grid-template-columns: 1fr 1fr; } }
        .form-group { display: flex; flex-direction: column; position: relative; }
        
        .form-group:not(.no-indicator)::after {
            content: '*'; position: absolute; right: 15px; top: 39px; font-size: 0.9em; font-weight: bold;
            color: var(--error-color); pointer-events: none; transition: opacity 0.3s ease, content 0.3s ease;
        }
        .form-group:not(.no-indicator):has(input:required:valid),
        .form-group:not(.no-indicator):has(select:required:valid:not([value=""])) {
             border-left-color: var(--success-color);
        }
        .form-group:not(.no-indicator):has(input:required:valid)::after,
        .form-group:not(.no-indicator):has(select:required:valid:not([value=""]))::after,
        .form-group:has(input#esExterna:checked)::after {
            content: '✓'; color: var(--success-color);
        }
        .form-group.is-valid-optional::after {
            content: '✓'; color: var(--success-color); position: absolute; right: 15px; top: 39px; font-weight: bold;
        }
        input:required:valid, select:required:valid:not([value=""]) { border-left-color: var(--success-color) !important; }
        input:required:invalid:not(:placeholder-shown), select:required:invalid:not([value=""]) { border-left-color: var(--error-color) !important; }

        .full-width { grid-column: 1 / -1; }
        label { font-weight: 500; margin-bottom: 8px; }
        input, select {
            width: 100%; padding: 12px; padding-right: 35px; border: 1px solid var(--border-color);
            border-left: 4px solid var(--border-color); border-radius: 6px; box-sizing: border-box;
            transition: border-color 0.3s, box-shadow 0.3s, border-left-color 0.3s;
        }
        input:focus, select:focus {
            outline: none; border-color: var(--secondary-color); box-shadow: 0 0 0 3px rgba(0, 90, 156, 0.25);
        }
        input[readonly] { background-color: #e9ecef; border-left-color: var(--border-color) !important; color: #555; }
        fieldset {
            border: 1px solid var(--border-color); border-top: 3px solid var(--secondary-color); border-radius: 8px;
            padding: 20px; grid-column: 1 / -1; display: grid; grid-template-columns: 1fr; gap: 20px;
        }
        @media (min-width: 768px) { fieldset { grid-template-columns: 1fr 1fr; } }
        legend { font-weight: 700; color: var(--primary-color); padding: 0 10px; margin-left: 10px; }
        .button-container {
            grid-column: 1 / -1; display: flex; justify-content: center; gap: 20px; padding-top: 10px;
        }
        button {
            padding: 12px 25px; border: none; border-radius: 6px; color: #fff; font-size: 16px; font-weight: 500;
            cursor: pointer; transition: background-color 0.3s, transform 0.2s;
        }
        #btn-guardar { background-color: var(--secondary-color); }
        #btn-guardar:hover { background-color: var(--primary-color); transform: translateY(-2px); }
        #btn-guardar:disabled { background-color: #6c757d; cursor: not-allowed; }
        #btn-limpiar { background-color: #6c757d; }
        #btn-limpiar:hover { background-color: #5a6268; transform: translateY(-2px); }
        .checkbox-container { display: flex; align-items: center; margin-top: 8px; }
        .checkbox-container input { width: auto; margin-right: 8px; padding-right: 0; }
        .checkbox-container label { margin: 0; font-weight: normal; }
        .section-footer { margin-top: 10px; padding-top: 20px; }
        .recursos-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-top: 15px;
        }
        .recurso-card {
            background-color: #fff; border: 1px solid #ddd; border-radius: 8px; padding: 20px;
            text-align: center; transition: transform 0.3s, box-shadow 0.3s;
            display: flex; flex-direction: column; align-items: center; cursor: pointer;
        }
        .recurso-card:hover { transform: translateY(-5px); box-shadow: 0 8px 15px rgba(0,0,0,0.1); }
        .recurso-card .icon { font-size: 2.5em; color: var(--secondary-color); margin-bottom: 15px; }
        .recurso-card h4 {
            font-size: 1.1em; color: var(--primary-color); margin: 0 0 10px 0; border: none; padding: 0;
        }
        .recurso-card a { text-decoration: none; color: var(--text-color); font-weight: 500; }
        .recurso-card:hover h4 { color: var(--secondary-color); }
        
        .auditor-table-container {
            border-radius: 8px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.05); border: 1px solid var(--border-color);
        }
        .auditor-table { width: 100%; border-collapse: collapse; font-size: 14px; }
        .auditor-table th, .auditor-table td { border-bottom: 1px solid var(--border-color); padding: 12px 15px; }
        .auditor-table th { background-color: var(--primary-color); color: #fff; font-weight: 500; text-align: center; }
        .auditor-table td { text-align: left; font-weight: 500; }
        .auditor-table tbody tr:nth-child(even) { background-color: var(--light-gray); }
        .auditor-table tbody tr:last-child td { border-bottom: none; }
        .auditor-table tbody tr:hover { background-color: var(--light-blue-bg); }
        .auditor-table a { color: var(--secondary-color); text-decoration: none; font-weight: 500; }
        .auditor-table a:hover { text-decoration: underline; }

        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); display: none; justify-content: center; align-items: center; z-index: 1000;
        }
        .modal-container {
            background: #fff; padding: 30px; border-radius: 8px;
            width: 90%; max-width: 600px; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            position: relative;
            max-height: 80vh; /* Límite de altura */
            overflow-y: auto; /* Scroll si el contenido es muy largo */
        }
        .modal-close {
            position: absolute; top: 10px; right: 15px; font-size: 24px;
            font-weight: bold; cursor: pointer; color: #888;
        }
        .modal-close:hover { color: #000; }
        .modal-container h3 {
            margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 15px;
        }
        .modal-container ul { list-style: none; padding: 0; }
        .modal-container li { margin-bottom: 10px; }
        .modal-container a { color: var(--secondary-color); text-decoration: none; font-weight: 500; }
        .modal-container a:hover { text-decoration: underline; }

        /* --- INICIO: ESTILOS PARA LA NUEVA MODAL DE VERIFICACIÓN --- */
        #existingUserModal .modal-container {
            max-width: 750px;
            display: flex;
            flex-direction: column;
        }
        #existingUserModal .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
            position: relative;
            gap: 15px;
        }
        #existingUserModal .modal-header h3 {
            margin: 0;
            font-size: 1.4rem;
            color: var(--primary-color);
            flex-grow: 1;
            padding: 0;
            border: none;
        }
        #existingUserModal .modal-copy-indicator {
            cursor: pointer;
            font-size: 0.9rem;
            color: #6c757d;
            padding: 5px 10px;
            border-radius: 5px;
            background-color: var(--light-gray);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.2s ease;
            border: 1px solid var(--border-color);
            white-space: nowrap;
        }
        #existingUserModal .modal-copy-indicator:hover {
            background-color: #d1d6db;
        }
        #existingUserModal .modal-body {
            max-height: 45vh;
            overflow-y: auto;
            padding-right: 10px;
            margin-top: 20px;
        }
        #existingUserModal .modal-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        #existingUserModal .modal-table th,
        #existingUserModal .modal-table td {
            padding: 10px 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        #existingUserModal .modal-table th {
            background-color: var(--light-gray);
            color: var(--text-color);
            font-weight: 500;
            width: 35%;
        }
        #existingUserModal .highlight-text {
            background-color: #fff3cd;
            font-weight: bold;
            padding: 2px 5px;
            border-radius: 3px;
        }
        #existingUserModal .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            padding-top: 20px;
            margin-top: 20px;
            border-top: 1px solid #eee;
        }
        #existingUserModal .modal-button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        #existingUserModal .modal-button.accept {
            background-color: var(--error-color);
            color: white;
        }
        #existingUserModal .modal-button.accept:hover {
            background-color: #c82333;
            transform: translateY(-2px);
        }
        #existingUserModal .modal-button.continue {
            background-color: var(--secondary-color);
            color: white;
        }
        #existingUserModal .modal-button.continue:hover {
            background-color: var(--primary-color);
            transform: translateY(-2px);
        }

/* --- ESTILO TABLA --- */ 
    </style>
</head>
<body>
    <header class="header-banner">
        <div class="header-content">
            <img src="https://res.cloudinary.com/dveuk1nve/image/upload/v1759086382/logo_2_GPE-remove_evrvxr.png" alt="Logo EsSalud">
            <h1>GERENCIA DE PRESTACIONES ECONÓMICAS</h1>
        </div>
    </header>

    <div class="container">
        <h2>FORMULARIO DE INGRESO DE DATOS</h2>
        <p class="form-description">
            Acceso al SIGI: MÉDICO DE CONTROL, COMAI, COMECI, OGIT, JEFE OSPE
        </p>

        <form id="formulario" novalidate>
            <fieldset>
                <legend>Identificación de la IPRESS</legend>
                <div class="form-group">
                    <label for="red">RED:</label>
                    <select id="red" required onchange="actualizarIpress()"><option value="">Seleccione una Red</option></select>
                </div>
                <div class="form-group">
                    <label for="ipress">IPRESS:</label>
                    <select id="ipress" required onchange="asignarCodigoIpress()"><option value="">Seleccione una IPRESS</option></select>
                </div>
                <div class="form-group no-indicator">
                    <label for="tipo">TIPO:</label>
                    <input id="tipo" readonly>
                </div>
                <div class="form-group no-indicator">
                    <label for="codigoIpress">CÓDIGO DE IPRESS:</label>
                    <input id="codigoIpress" readonly>
                </div>
            </fieldset>

            <fieldset>
                <legend>Datos del Profesional</legend>
                <div class="form-group">
                    <label for="apellidos">APELLIDOS:</label>
                    <input id="apellidos" required pattern="[A-Za-zñÑ\s]+" oninput="this.value = this.value.toUpperCase().replace(/[^A-ZÑ\s]/g, '')">
                </div>
                <div class="form-group">
                    <label for="nombres">NOMBRES:</label>
                    <input id="nombres" required pattern="[A-Za-zñÑ\s]+" oninput="this.value = this.value.toUpperCase().replace(/[^A-ZÑ\s]/g, '')">
                </div>
                <div class="form-group">
                    <label for="tipoDoc">TIPO DE DOCUMENTO:</label>
                    <select id="tipoDoc" required><option value="DNI">DNI</option><option value="CE">CARNE DE EXTRANJERIA</option></select>
                </div>
                <div class="form-group">
                    <label for="numeroDoc">NÚMERO DE DOCUMENTO:</label>
                    <input id="numeroDoc" type="text" required onblur="padearDocumento(this)">
                </div>
                <div class="form-group">
                    <label for="cargo">CARGO:</label>
                    <select id="cargo" required>
                        <option value="">Seleccione un Cargo</option>
                        <option value="MEDICO DE CONTROL">MÉDICO DE CONTROL</option>
                        <option value="OGIT">OGIT</option>
                        <option value="COMAI">COMAI</option>
                        <option value="COMECI">COMECI</option>
                        <option value="JEFE">JEFE OSPE</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="profesional">PROFESIONAL:</label>
                    <select id="profesional" required>
                        <option value="">Seleccione una Profesión</option>
                        <option value="MEDICO">MÉDICO</option>
                        <option value="OBSTETRA">OBSTETRA</option>
                        <option value="INGENIERO">INGENIERO</option>
                        <option value="ODONTOLOGO">ODONTOLOGO</option>
                        <option value="ADMINISTRADOR">ADMINISTRADOR</option>
                        <option value="ABOGADO">ABOGADO</option>
                        <option value="CONTADOR">CONTADOR</option>
                        <option value="LICENCIADO">LICENCIADO</option>
                        <option value="OTROS">OTROS PROFESIONALES</option>
                    </select>
                </div>
            </fieldset>

            <fieldset>
                <legend>Detalles de la Designación</legend>
                <div class="form-group">
                    <label for="codigoPlanilla">CÓDIGO DE PLANILLA:</label>
                    <input id="codigoPlanilla" placeholder="8 dígitos o marque externa" required>
                    <div class="checkbox-container">
                        <input type="checkbox" id="esExterna" onclick="togglePlanilla(this)">
                        <label for="esExterna">IPRESS Externa</label>
                    </div>
                </div>
                <div class="form-group">
                    <label for="colegiatura">COLEGIATURA (CMP):</label>
                    <input id="colegiatura" type="text" onblur="padearConCeros(this, 6)" placeholder="6 dígitos" required>
                </div>
                <div class="form-group full-width">
                    <label for="numResolucion">NÚMERO DE RESOLUCIÓN:</label>
                    <input id="numResolucion" required oninput="this.value = this.value.toUpperCase()" placeholder="Ej: RESOLUCION DIRECTORAL Nº20-HIII SA-RPR-ESSALUD-2025">
                </div>
                <div class="form-group">
                    <label for="fechaEmision">FECHA DE EMISIÓN DE RESOLUCIÓN:</label>
                    <input id="fechaEmision" type="date" required onchange="validarFechas()">
                </div>
                <div class="form-group">
                    <label for="fechaTermino">FECHA DE TÉRMINO DE VIGENCIA:</label>
                    <input id="fechaTermino" type="date" required onchange="validarFechas()">
                </div>
                <div class="full-width" id="duracionVigencia" style="font-style: italic; color: #555; height: 12px;"></div>
                <div class="form-group full-width">
                    <label for="archivo">CARGAR RESOLUCIÓN (PDF o Imagen):</label>
                    <input id="archivo" type="file" accept="image/*,.pdf" required>
                </div>
            </fieldset>
            
            <fieldset>
                 <legend>Información de Contacto y Solicitud</legend>
                 <div class="form-group">
                    <label for="telefono">TELÉFONO PERSONAL:</label>
                    <input id="telefono" type="tel" required placeholder="Debe empezar con 9">
                </div>
                <div class="form-group no-indicator">
                    <label for="telefonoIpress">TELÉFONO IPRESS:</label>
                    <input id="telefonoIpress" type="tel">
                </div>
                <div class="form-group">
                    <label for="correoInstitucional">CORREO INSTITUCIONAL:</label>
                    <input id="correoInstitucional" type="email" required placeholder="usuario@essalud.gob.pe" list="institutional-domains" oninput="updateEmailDatalist(this, 'institutional-domains')">
                    <datalist id="institutional-domains">
                        <option value="@essalud.gob.pe"></option>
                    </datalist>
                    <div class="checkbox-container">
                        <input type="checkbox" id="noCorreoInstitucional" onclick="toggleCorreoInstitucional(this)">
                        <label for="noCorreoInstitucional">Sin correo @essalud.gob.pe</label>
                    </div>
                    </div>
                <div class="form-group">
                    <label for="correoParticular">CORREO PARTICULAR:</label>
                    <input id="correoParticular" type="email" required list="personal-domains" oninput="updateEmailDatalist(this, 'personal-domains')">
                    <datalist id="personal-domains">
                        <option value="@gmail.com"></option>
                        <option value="@hotmail.com"></option>
                        <option value="@outlook.com"></option>
                        <option value="@yahoo.es"></option>
                    </datalist>
                </div>
                <div class="form-group">
                    <label for="solicitud">TIPO DE SOLICITUD:</label>
                    <select id="solicitud" required>
                        <option value="ACCESO SIGI" selected>ACCESO SIGI</option>
                        <option value="CAPACITACION">CAPACITACIÓN</option>
                        <option value="RENOVACIÓN DE CONTRASEÑA">RENOVACIÓN DE CONTRASEÑA</option>
                    </select>
                </div>
                <div class="form-group no-indicator">
                    <label for="auditor">MÉDICO AUDITOR GPE:</label>
                    <input id="auditor" readonly>
                </div>
            </fieldset>

            <div class="button-container">
                <button id="btn-limpiar" type="button" onclick="limpiarFormulario()">Limpiar</button>
                <button id="btn-guardar" type="button" onclick="guardarDatos()">Guardar</button>
            </div>
        </form>

        <hr class="section-divider">

        <div class="section-footer">
            <h2 id="capacitaciones-title">CAPACITACIONES Y RECURSOS</h2>
            <div class="recursos-grid">
                <div id="open-video-modal" class="recurso-card">
                    <div class="icon"><i class="fa-solid fa-video"></i></div>
                    <h4>Videos de Capacitación</h4>
                </div>
                <a href="https://drive.google.com/drive/folders/19HOU_ju25L7zdnh7cHV8Rp2V5__t4gLz" target="_blank" class="recurso-card">
                    <div class="icon"><i class="fa-solid fa-file-pdf"></i></div>
                    <h4>Normas y Documentos</h4>
                </a>
                <a href="https://docs.google.com/document/d/1OHAuyvJut1kySilT3YEExKEJUKSTuU4ZTtGHYh9FrNw/edit?usp=sharing" target="_blank" class="recurso-card">
                    <div class="icon"><i class="fa-solid fa-user-check"></i></div>
                    <h4>Auditor Asignado</h4>
                </a>
            </div>
        </div>
        
        <hr class="section-divider">

        <div class="section-footer">
            <h2 id="auditores-title">AUDITORES POR RED</h2>
            <div class="auditor-table-container">
                <table class="auditor-table">
                    <thead>
                        <tr>
                            <th>AUDITOR</th>
                            <th>REDES ASIGNADAS</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><a href="mailto:maria.delgadom@essalud.gob.pe">maria.delgadom@essalud.gob.pe</a></td>
                            <td>CAJAMARCA, GCSPE, CUSCO, ICA, SABOGAL, TARAPOTO</td>
                        </tr>
                        <tr>
                            <td><a href="mailto:monica.echarry@essalud.gob.pe">monica.echarry@essalud.gob.pe</a></td>
                            <td>AMAZONAS, AYACUCHO, HUANUCO, LAMBAYEQUE, REBAGLIATI, TUMBES</td>
                        </tr>
                        <tr>
                            <td><a href="mailto:kathia.vega@essalud.gob.pe">kathia.vega@essalud.gob.pe</a></td>
                            <td>AREQUIPA</td>
                        </tr>
                        <tr>
                            <td><a href="mailto:jeannette.motta@essalud.gob.pe">jeannette.motta@essalud.gob.pe</a></td>
                            <td>ANCASH, JUNIN, PASCO, PIURA</td>
                        </tr>
                        <tr>
                            <td><a href="mailto:yohny.torres@essalud.gob.pe">yohny.torres@essalud.gob.pe</a></td>
                            <td>APURIMAC, OFERTA FLEXIBLE, LORETO, MOQUEGUA, PUNO, UCAYALI</td>
                        </tr>
                        <tr>
                            <td><a href="mailto:ruben.pena@essalud.gob.pe">ruben.pena@essalud.gob.pe</a></td>
                            <td>INSTITUTO NACIONAL CARDIOVASCULAR, CENTRO NACIONAL DE SALUD RENAL, MADRE DE DIOS, MOYOBAMBA</td>
                        </tr>
                        <tr>
                            <td><a href="mailto:david.romero@essalud.gob.pe">david.romero@essalud.gob.pe</a></td>
                            <td>ALMENARA, HUANCAVELICA, JULIACA, LA LIBERTAD, TACNA, JAEN, HUARAZ</td>
                        </tr>
                        <tr>
                            <td><a href="mailto:william.arana@essalud.gob.pe">william.arana@essalud.gob.pe</a></td>
                            <td>COORDINADOR GPE DE LAS OSPE</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="video-modal" class="modal-overlay">
        <div class="modal-container">
            <span id="close-modal-button" class="modal-close">&times;</span>
            <h3>Videos de Capacitación</h3>
            <ul>
                <li><a href="https://www.youtube.com/live/_z28602ui9A" target="_blank">CENATE 10.10.2025 (Uso de aplicativos informáticos II)</a></li>
                <li><a href="https://www.youtube.com/live/tsfhZianvGU" target="_blank">CENATE 20.08.2025 (Uso de aplicativos informáticos I)</a></li>
                <li><a href="https://www.youtube.com/live/lJyopRFUAag?si=5E35Icv-C9htTxAE" target="_blank">CENATE 20.07.2025 (Actividades del Médico de Control)</a></li>
                <li><a href="https://www.youtube.com/live/9V1TZwRH0Xw?si=9dRQePwtBjC82iH4" target="_blank">CENATE 20.06.2025 (Pase a la COMECI)</a></li>
                <li><a href="https://www.youtube.com/live/JxMMLKFnI2A" target="_blank">CENATE 14.05.2025 (RESUMEN General)</a></li>
                <li><a href="https://youtu.be/R3tkxfIi7cY" target="_blank">SESIÓN 1 (Normativa Vigente)</a></li>
                <li><a href="https://youtu.be/9gcG5xsQ7n8" target="_blank">SESIÓN 2 (Procesos de Emisión CITT)</a></li>
                <li><a href="https://youtu.be/o-cQVxfB-ww" target="_blank">SESIÓN 3 (Metodología y Actividades)</a></li>
                <li><a href="https://youtu.be/h0X7MqMWCp0" target="_blank">SESIÓN 4 (Análisis ITP y Derivación)</a></li>
            </ul>
        </div>
    </div>

    <div id="existingUserModal" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h3 id="modalTitle">Registro Encontrado</h3>
                <div class="modal-copy-indicator" onclick="copyModalContentToClipboard()">
                    <i class="fa-solid fa-copy"></i> Copiar
                </div>
                <span class="modal-close" onclick="closeCheckModal()">&times;</span>
            </div>
            <div class="modal-body" id="modalBodyContent">
                <p>Cargando datos...</p>
            </div>
            <div class="modal-footer">
                <button class="modal-button accept" onclick="closeCheckModal()">NO CONTINUAR con registro</button>
                <button class="modal-button continue" onclick="continueWithExistingData()">CONTINUAR o EDITAR registro</button>
            </div>
        </div>
    </div>
    <script>
        // =========================================================================
        // INICIO: LÓGICA PARA VERIFICACIÓN DE USUARIO EXISTENTE
        // =========================================================================

        // --- CONFIGURACIÓN ---
        const SHEETS_API_URL = 'https://script.google.com/macros/s/AKfycbx78VHM17wHa1dDho7Zn-j-sXpC_oHyc--4MAuBJF6i3SuPWjpeno4AY_VsArdrnyeQXg/exec';

        const numeroDocInput = document.getElementById('numeroDoc');
        const existingUserModal = document.getElementById('existingUserModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalBodyContent = document.getElementById('modalBodyContent');
        let registroEncontrado = null; // MEJORA 2b: Variable para guardar el registro

        // Agregamos el listener sin sobreescribir el onblur existente
        numeroDocInput.addEventListener('blur', checkExistingUser);

        async function checkExistingUser() {
            registroEncontrado = null; // Limpiamos el registro anterior
            const numeroDocumento = numeroDocInput.value.trim();
            if (numeroDocumento === '') return;

            numeroDocInput.style.cursor = 'wait';

            try {
                const response = await fetch(SHEETS_API_URL);
                if (!response.ok) throw new Error(`Error HTTP: ${response.status}`);
                
                const data = await response.json();
                
                const existingRecord = data.reverse().find(record => 
                    record['NumeroDocumento'] && String(record['NumeroDocumento']).trim() === numeroDocumento
                );

                if (existingRecord) {
                    registroEncontrado = existingRecord; // MEJORA 2b: Guardamos el registro
                    showModal(existingRecord);
                }
            } catch (error) {
                console.error('Error al verificar el documento:', error);
                alert('Ocurrió un error al verificar el documento. Por favor, revisa la consola para más detalles.');
            } finally {
                numeroDocInput.style.cursor = 'default';
            }
        }

        function showModal(record) {
            const { Cargo, Red, IPRESS, Nombres, Apellidos } = record;
            
            modalTitle.textContent = `ACCESO AL SIGI - ${Cargo || ''} - ${Red || ''} - ${IPRESS || ''} - ${Nombres || ''} ${Apellidos || ''}`;

            const fieldsToShow = [
                { label: 'RED', key: 'Red' }, { label: 'IPRESS', key: 'IPRESS' },
                { label: 'Apellidos', key: 'Apellidos', highlight: true },
                { label: 'Nombres', key: 'Nombres', highlight: true },
                { label: 'Tipo Documento', key: 'TipoDocumento' },
                { label: 'Nro Documento', key: 'NumeroDocumento', highlight: true },
                { label: 'Cargo', key: 'Cargo' }, { label: 'Profesional', key: 'Profesional' },
                { label: 'Colegiatura (CMP)', key: 'Colegiatura' },
                { label: 'N° Resolución', key: 'Resolucion' },
                { label: 'Inicio Vigencia', key: 'FechaEmision', isDate: true },
                { label: 'Fin Vigencia', key: 'FechaTermino', isDate: true },
                { label: 'Celular', key: 'Telefono' },
                { label: 'Correo Institucional', key: 'CorreoInstitucional' },
                { label: 'Correo Personal', key: 'CorreoParticular' },
                { label: 'Url Archivo', key: 'UrlArchivo', isLink: true }
            ];

            let tableHTML = `<table class="modal-table"><tbody>`;
            fieldsToShow.forEach(({ label, key, highlight, isDate, isLink }) => {
                let value = record[key] || 'No registrado';
                let displayValue = value;
                
                if (isDate && value !== 'No registrado') {
                    displayValue = new Date(value).toLocaleDateString('es-PE', { timeZone: 'UTC' });
                }
                if (isLink && value !== 'No registrado') {
                    displayValue = `<a href="${value}" target="_blank">Ver Archivo</a>`;
                }
                if (highlight) {
                    displayValue = `<span class="highlight-text">${displayValue}</span>`;
                }

                tableHTML += `<tr><th>${label}:</th><td>${displayValue}</td></tr>`;
            });
            tableHTML += `</tbody></table>`;
            
            modalBodyContent.innerHTML = tableHTML;
            existingUserModal.style.display = 'flex';
        }

        function closeCheckModal() {
            existingUserModal.style.display = 'none';
        }

        async function copyModalContentToClipboard() {
            const title = modalTitle.textContent;
            const table = modalBodyContent.querySelector('.modal-table');
            if (!table) return;

            let textToCopy = `${title}\n\n`;
            table.querySelectorAll('tr').forEach(row => {
                const th = row.querySelector('th').textContent;
                const td = row.querySelector('td').textContent;
                textToCopy += `${th} ${td}\n`;
            });

            try {
                await navigator.clipboard.writeText(textToCopy);
                alert('¡Datos copiados al portapapeles!');
            } catch (err) {
                console.error('Error al copiar:', err);
                alert('No se pudo copiar. Inténtalo manualmente.');
            }
        }

        // MEJORA 2b: La función ahora es más simple y rápida
        function continueWithExistingData() {
            if (registroEncontrado) {
                fillFormWithData(registroEncontrado);
                closeCheckModal();
                alert('Formulario rellenado con los datos existentes. Puedes modificar y enviar.');
            } else {
                alert('Error: No se encontró el registro para rellenar el formulario.');
            }
        }

        function fillFormWithData(record) {
            const formFieldMap = {
                'Red': 'red', 'IPRESS': 'ipress', 'CodigoIPRESS': 'codigoIpress',
                'Apellidos': 'apellidos', 'Nombres': 'nombres',
                'TipoDocumento': 'tipoDoc', 'NumeroDocumento': 'numeroDoc',
                'Cargo': 'cargo', 'Profesional': 'profesional',
                'CodigoPlanilla': 'codigoPlanilla', 'Colegiatura': 'colegiatura',
                'Resolucion': 'numResolucion', 'FechaEmision': 'fechaEmision',
                'FechaTermino': 'fechaTermino', 'Telefono': 'telefono',
                'CorreoInstitucional': 'correoInstitucional',
                'CorreoParticular': 'correoParticular', 'TipoSolicitud': 'solicitud',
                'Auditor': 'auditor'
            };

            const redSelect = document.getElementById('red');
            redSelect.value = record['Red'];
            actualizarIpress();

            setTimeout(() => {
                for (const sheetKey in formFieldMap) {
                    const inputId = formFieldMap[sheetKey];
                    const inputElement = document.getElementById(inputId);
                    let value = record[sheetKey];

                    if (inputElement && (value !== undefined && value !== null)) {
                        if (inputElement.type === 'date' && value) {
                            inputElement.value = value.substring(0, 10);
                        } else {
                            inputElement.value = value;
                        }
                    }
                }
                asignarCodigoIpress();
                validarFechas();
            }, 200);
        }

        // =========================================================================
        // FIN: LÓGICA PARA VERIFICACIÓN DE USUARIO EXISTENTE
        // =========================================================================

        const datosExcel = [
            { "codigoRed": 2, "red": "ALMENARA", "tipo": "PRESTACIONAL", "codigoIpress": 478, "ipress": "CAP III ALFREDO PIAZZA ROBERTS" },
            { "codigoRed": 2, "red": "ALMENARA", "tipo": "PRESTACIONAL", "codigoIpress": 446, "ipress": "CAP III EL AGUSTINO" },
            { "codigoRed": 2, "red": "ALMENARA", "tipo": "PRESTACIONAL", "codigoIpress": 447, "ipress": "CAP III HUAYCAN" },
            { "codigoRed": 2, "red": "ALMENARA", "tipo": "PRESTACIONAL", "codigoIpress": 481, "ipress": "CAP III INDEPENDENCIA" },
            { "codigoRed": 2, "red": "ALMENARA", "tipo": "PRESTACIONAL", "codigoIpress": 20, "ipress": "CM CASAPALCA" },
            { "codigoRed": 2, "red": "ALMENARA", "tipo": "PRESTACIONAL", "codigoIpress": 406, "ipress": "HI AURELIO DIAZ-UFANO Y PERAL" },
            { "codigoRed": 2, "red": "ALMENARA", "tipo": "PRESTACIONAL", "codigoIpress": 404, "ipress": "HI JORGE VOTO BERNALES CORPANCHO" },
            { "codigoRed": 2, "red": "ALMENARA", "tipo": "PRESTACIONAL", "codigoIpress": 17, "ipress": "HII RAMON CASTILLA" },
            { "codigoRed": 2, "red": "ALMENARA", "tipo": "PRESTACIONAL", "codigoIpress": 403, "ipress": "HII SAN ISIDRO LABRADOR" },
            { "codigoRed": 2, "red": "ALMENARA", "tipo": "PRESTACIONAL", "codigoIpress": 8, "ipress": "HII VITARTE" },
            { "codigoRed": 2, "red": "ALMENARA", "tipo": "PRESTACIONAL", "codigoIpress": 7, "ipress": "HIII HOSPITAL DE EMERGENCIAS GRAU" },
            { "codigoRed": 2, "red": "ALMENARA", "tipo": "PRESTACIONAL", "codigoIpress": 2, "ipress": "HN GUILLERMO ALMENARA IRIGOYEN" },
            { "codigoRed": 2, "red": "ALMENARA", "tipo": "PRESTACIONAL", "codigoIpress": 23, "ipress": "PM CONSTRUCCION CIVIL" },
            { "codigoRed": 2, "red": "ALMENARA", "tipo": "PRESTACIONAL", "codigoIpress": 11, "ipress": "POL CHOSICA" },
            { "codigoRed": 2, "red": "ALMENARA", "tipo": "PRESTACIONAL", "codigoIpress": 14, "ipress": "POL FRANCISCO PIZARRO" },
            { "codigoRed": 2, "red": "ALMENARA", "tipo": "PRESTACIONAL", "codigoIpress": 376, "ipress": "POL SAN LUIS" },
            { "codigoRed": 5, "red": "AMAZONAS", "tipo": "ASISTENCIAL", "codigoIpress": 507, "ipress": "CAP I IMAZA" },
            { "codigoRed": 5, "red": "AMAZONAS", "tipo": "ASISTENCIAL", "codigoIpress": 156, "ipress": "CAP I LAMUD" },
            { "codigoRed": 5, "red": "AMAZONAS", "tipo": "ASISTENCIAL", "codigoIpress": 157, "ipress": "CAP I LONYA GRANDE" },
            { "codigoRed": 5, "red": "AMAZONAS", "tipo": "ASISTENCIAL", "codigoIpress": 158, "ipress": "CAP I OCALLI" },
            { "codigoRed": 5, "red": "AMAZONAS", "tipo": "ASISTENCIAL", "codigoIpress": 159, "ipress": "CAP I PEDRO RUIZ GALLO" },
            { "codigoRed": 5, "red": "AMAZONAS", "tipo": "ASISTENCIAL", "codigoIpress": 160, "ipress": "CAP II RODRIGUEZ DE MENDOZA" },
            { "codigoRed": 5, "red": "AMAZONAS", "tipo": "ASISTENCIAL", "codigoIpress": 377, "ipress": "CAP II SANTA MARIA DE NIEVA" },
            { "codigoRed": 5, "red": "AMAZONAS", "tipo": "ASISTENCIAL", "codigoIpress": 153, "ipress": "HI EL BUEN SAMARITANO" },
            { "codigoRed": 5, "red": "AMAZONAS", "tipo": "ASISTENCIAL", "codigoIpress": 154, "ipress": "HI HEROES DEL CENEPA" },
            { "codigoRed": 5, "red": "AMAZONAS", "tipo": "ASISTENCIAL", "codigoIpress": 155, "ipress": "HI HIGOS URCO" },
            { "codigoRed": 6, "red": "ANCASH", "tipo": "ASISTENCIAL", "codigoIpress": 185, "ipress": "CAP II SAN JACINTO" },
            { "codigoRed": 6, "red": "ANCASH", "tipo": "ASISTENCIAL", "codigoIpress": 165, "ipress": "CM CASMA" },
            { "codigoRed": 6, "red": "ANCASH", "tipo": "ASISTENCIAL", "codigoIpress": 166, "ipress": "CM COISHCO" },
            { "codigoRed": 6, "red": "ANCASH", "tipo": "ASISTENCIAL", "codigoIpress": 169, "ipress": "CM HUARMEY" },
            { "codigoRed": 6, "red": "ANCASH", "tipo": "ASISTENCIAL", "codigoIpress": 170, "ipress": "CM SIHUAS" },
            { "codigoRed": 6, "red": "ANCASH", "tipo": "ASISTENCIAL", "codigoIpress": 167, "ipress": "HI CONO SUR" },
            { "codigoRed": 6, "red": "ANCASH", "tipo": "ASISTENCIAL", "codigoIpress": 161, "ipress": "HIII CHIMBOTE" },
            { "codigoRed": 6, "red": "ANCASH", "tipo": "ASISTENCIAL", "codigoIpress": 171, "ipress": "PM CABANA" },
            { "codigoRed": 6, "red": "ANCASH", "tipo": "ASISTENCIAL", "codigoIpress": 175, "ipress": "PM CONCHUCOS" },
            { "codigoRed": 6, "red": "ANCASH", "tipo": "ASISTENCIAL", "codigoIpress": 379, "ipress": "PM PALLASCA" },
            { "codigoRed": 6, "red": "ANCASH", "tipo": "ASISTENCIAL", "codigoIpress": 178, "ipress": "PM PAMPAS" },
            { "codigoRed": 6, "red": "ANCASH", "tipo": "ASISTENCIAL", "codigoIpress": 487, "ipress": "POL VICTOR PANTA RODRIGUEZ" },
            { "codigoRed": 7, "red": "APURIMAC", "tipo": "ASISTENCIAL", "codigoIpress": 468, "ipress": "CAP I ANTABAMBA" },
            { "codigoRed": 7, "red": "APURIMAC", "tipo": "ASISTENCIAL", "codigoIpress": 70, "ipress": "CAP II CHALHUANCA" },
            { "codigoRed": 7, "red": "APURIMAC", "tipo": "ASISTENCIAL", "codigoIpress": 72, "ipress": "CAP II CHINCHEROS" },
            { "codigoRed": 7, "red": "APURIMAC", "tipo": "ASISTENCIAL", "codigoIpress": 512, "ipress": "CAP II COTABAMBAS" },
            { "codigoRed": 7, "red": "APURIMAC", "tipo": "ASISTENCIAL", "codigoIpress": 68, "ipress": "HI ANDAHUAYLAS" },
            { "codigoRed": 7, "red": "APURIMAC", "tipo": "ASISTENCIAL", "codigoIpress": 67, "ipress": "HII ABANCAY" },
            { "codigoRed": 7, "red": "APURIMAC", "tipo": "ASISTENCIAL", "codigoIpress": 71, "ipress": "PM CHUQUIBAMBILLA" },
            { "codigoRed": 7, "red": "APURIMAC", "tipo": "ASISTENCIAL", "codigoIpress": 69, "ipress": "PM CURAHUASI" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 87, "ipress": "CAP I CHIVAY" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 97, "ipress": "CAP I EL PEDREGAL" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 101, "ipress": "CAP I YURA" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 94, "ipress": "CAP II HUNTER" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 482, "ipress": "CAP III ALTO SELVA ALEGRE" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 80, "ipress": "CAP III MELITON SALAS TEJADA" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 522, "ipress": "CAP III MIRAFLORES" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 453, "ipress": "CAP III PAUCARPATA" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 83, "ipress": "CM APLAO" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 79, "ipress": "HI EDMUNDO ESCOMEL" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 75, "ipress": "HI SAMUEL PASTOR" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 74, "ipress": "HII MANUEL DE TORRES MUÑOZ" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 76, "ipress": "HIII YANAHUARA" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 3, "ipress": "HN CARLOS ALBERTO SEGUIN ESCOBEDO" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 82, "ipress": "PM ACARI" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 84, "ipress": "PM ATICO" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 85, "ipress": "PM CARAVELI" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 86, "ipress": "PM CHALA" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 88, "ipress": "PM CHUCARAPI" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 89, "ipress": "PM CHUQUIBAMBA" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 91, "ipress": "PM CORIRE" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 92, "ipress": "PM COTAHUASI" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 95, "ipress": "PM LA JOYA" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 96, "ipress": "PM MATARANI" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 99, "ipress": "PM SANTA RITA" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 100, "ipress": "PM VITOR" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 77, "ipress": "POL METROPOLITANO" },
            { "codigoRed": 8, "red": "AREQUIPA", "tipo": "ASISTENCIAL", "codigoIpress": 697, "ipress": "IPRESS PCC CERRO COLORADO" },
            { "codigoRed": 9, "red": "AYACUCHO", "tipo": "ASISTENCIAL", "codigoIpress": 103, "ipress": "CAP II HUANTA" },
            { "codigoRed": 9, "red": "AYACUCHO", "tipo": "ASISTENCIAL", "codigoIpress": 104, "ipress": "PM SAN MIGUEL" },
            { "codigoRed": 9, "red": "AYACUCHO", "tipo": "ASISTENCIAL", "codigoIpress": 109, "ipress": "PM SAN FRANCISCO" },
            { "codigoRed": 9, "red": "AYACUCHO", "tipo": "ASISTENCIAL", "codigoIpress": 110, "ipress": "PM VILCASHUAMAN" },
            { "codigoRed": 9, "red": "AYACUCHO", "tipo": "ASISTENCIAL", "codigoIpress": 425, "ipress": "CAP I HUANCASANCOS" },
            { "codigoRed": 9, "red": "AYACUCHO", "tipo": "ASISTENCIAL", "codigoIpress": 449, "ipress": "CAP III METROPOLITANO" },
            { "codigoRed": 9, "red": "AYACUCHO", "tipo": "ASISTENCIAL", "codigoIpress": 102, "ipress": "HII HUAMANGA" },
            { "codigoRed": 9, "red": "AYACUCHO", "tipo": "ASISTENCIAL", "codigoIpress": 105, "ipress": "PM CANGALLO" },
            { "codigoRed": 9, "red": "AYACUCHO", "tipo": "ASISTENCIAL", "codigoIpress": 423, "ipress": "PM QUEROBAMBA" },
            { "codigoRed": 9, "red": "AYACUCHO", "tipo": "ASISTENCIAL", "codigoIpress": 428, "ipress": "PM HUANCAPI" },
            { "codigoRed": 10, "red": "CAJAMARCA", "tipo": "ASISTENCIAL", "codigoIpress": 501, "ipress": "CAP II LOS BAÑOS DEL INCA" },
            { "codigoRed": 10, "red": "CAJAMARCA", "tipo": "ASISTENCIAL", "codigoIpress": 192, "ipress": "CM CAJABAMBA" },
            { "codigoRed": 10, "red": "CAJAMARCA", "tipo": "ASISTENCIAL", "codigoIpress": 199, "ipress": "CAP I HUALGAYOC" },
            { "codigoRed": 10, "red": "CAJAMARCA", "tipo": "ASISTENCIAL", "codigoIpress": 193, "ipress": "CM CELENDIN" },
            { "codigoRed": 10, "red": "CAJAMARCA", "tipo": "ASISTENCIAL", "codigoIpress": 191, "ipress": "HII CAJAMARCA" },
            { "codigoRed": 10, "red": "CAJAMARCA", "tipo": "ASISTENCIAL", "codigoIpress": 196, "ipress": "PM BAMBAMARCA" },
            { "codigoRed": 10, "red": "CAJAMARCA", "tipo": "ASISTENCIAL", "codigoIpress": 201, "ipress": "PM SAN MARCOS" },
            { "codigoRed": 10, "red": "CAJAMARCA", "tipo": "ASISTENCIAL", "codigoIpress": 202, "ipress": "PM SAN MIGUEL" },
            { "codigoRed": 10, "red": "CAJAMARCA", "tipo": "ASISTENCIAL", "codigoIpress": 204, "ipress": "PM TEMBLADERA" },
            { "codigoRed": 10, "red": "CAJAMARCA", "tipo": "ASISTENCIAL", "codigoIpress": 203, "ipress": "PM SAN PABLO" },
            { "codigoRed": 10, "red": "CAJAMARCA", "tipo": "ASISTENCIAL", "codigoIpress": 198, "ipress": "PM CONTUMAZA" },
            { "codigoRed": 10, "red": "CAJAMARCA", "tipo": "ASISTENCIAL", "codigoIpress": 216, "ipress": "PM BOLIVAR" },
            { "codigoRed": 11, "red": "CUSCO", "tipo": "ASISTENCIAL", "codigoIpress": 513, "ipress": "CAP I ECHARATE" },
            { "codigoRed": 11, "red": "CUSCO", "tipo": "ASISTENCIAL", "codigoIpress": 116, "ipress": "CM ACOMAYO" },
            { "codigoRed": 11, "red": "CUSCO", "tipo": "ASISTENCIAL", "codigoIpress": 118, "ipress": "CM CALCA" },
            { "codigoRed": 11, "red": "CUSCO", "tipo": "ASISTENCIAL", "codigoIpress": 121, "ipress": "CM MACHU PICCHU" },
            { "codigoRed": 11, "red": "CUSCO", "tipo": "ASISTENCIAL", "codigoIpress": 418, "ipress": "CM METROPOLITANO" },
            { "codigoRed": 11, "red": "CUSCO", "tipo": "ASISTENCIAL", "codigoIpress": 123, "ipress": "CM PAUCARTAMBO" },
            { "codigoRed": 11, "red": "CUSCO", "tipo": "ASISTENCIAL", "codigoIpress": 373, "ipress": "CM SANTIAGO" },
            { "codigoRed": 11, "red": "CUSCO", "tipo": "ASISTENCIAL", "codigoIpress": 119, "ipress": "CM URCOS" },
            { "codigoRed": 11, "red": "CUSCO", "tipo": "ASISTENCIAL", "codigoIpress": 112, "ipress": "HI ESPINAR" },
            { "codigoRed": 11, "red": "CUSCO", "tipo": "ASISTENCIAL", "codigoIpress": 113, "ipress": "HI QUILLABAMBA" },
            { "codigoRed": 11, "red": "CUSCO", "tipo": "ASISTENCIAL", "codigoIpress": 115, "ipress": "HI SICUANI" },
            { "codigoRed": 11, "red": "CUSCO", "tipo": "ASISTENCIAL", "codigoIpress": 114, "ipress": "HI URUBAMBA" },
            { "codigoRed": 11, "red": "CUSCO", "tipo": "ASISTENCIAL", "codigoIpress": 111, "ipress": "HN ADOLFO GUEVARA VELASCO" },
            { "codigoRed": 11, "red": "CUSCO", "tipo": "ASISTENCIAL", "codigoIpress": 134, "ipress": "PM SALVACION" },
            { "codigoRed": 11, "red": "CUSCO", "tipo": "ASISTENCIAL", "codigoIpress": 120, "ipress": "PM HUYRO" },
            { "codigoRed": 11, "red": "CUSCO", "tipo": "ASISTENCIAL", "codigoIpress": 126, "ipress": "POL SAN SEBASTIAN" },
            { "codigoRed": 11, "red": "CUSCO", "tipo": "ASISTENCIAL", "codigoIpress": 510, "ipress": "CAP I SANTO TOMAS" },
            { "codigoRed": 11, "red": "CUSCO", "tipo": "ASISTENCIAL", "codigoIpress": 698, "ipress": "CM PICHARI" },
            { "codigoRed": 91, "red": "GCGP", "tipo": "GERENCIA", "codigoIpress": 422, "ipress": "CENTRO DE ATENCION RAPIDA - MEDICO DE PERSONAL" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 674, "ipress": "CEVIT CENTRAL" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 10, "ipress": "OSPE TUMBES" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 20, "ipress": "OSPE PIURA" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 30, "ipress": "OSPE LAMBAYEQUE" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 50, "ipress": "OSPE AMAZONAS" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 60, "ipress": "OSPE LORETO" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 70, "ipress": "OSPE LA LIBERTAD" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 80, "ipress": "OSPE MOYOBAMBA" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 81, "ipress": "OSPE TARAPOTO" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 90, "ipress": "OSPE ANCASH" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 100, "ipress": "OSPE HUANUCO" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 109, "ipress": "OSPE SALAMANCA" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 111, "ipress": "OSPE SAN ISIDRO" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 112, "ipress": "OSPE CORPORATIVA" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 113, "ipress": "OSPE JESUS MARIA" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 114, "ipress": "OSPE SAN MIGUEL" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 116, "ipress": "OSPE SJLURIGANCHO" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 117, "ipress": "OSPE SMPORRAS" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 118, "ipress": "OSPE COMAS" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 120, "ipress": "OSPE HUACHO" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 130, "ipress": "OSPE PASCO" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERencia", "codigoIpress": 140, "ipress": "OSPE JUNIN" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 150, "ipress": "OSPE ICA" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 160, "ipress": "OSPE HUANCAVELICA" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 170, "ipress": "OSPE AYACUCHO" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 180, "ipress": "OSPE APURIMAC" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 190, "ipress": "OSPE CUSCO" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 200, "ipress": "OSPE MADRE DE DIOS" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 210, "ipress": "OSPE AREQUIPA" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 220, "ipress": "OSPE PUNO" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 221, "ipress": "OSPE JULIACA" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 230, "ipress": "OSPE MOQUEGUA" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 240, "ipress": "OSPE TACNA" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 250, "ipress": "OSPE UCAYALI" },
            { "codigoRed": 90, "red": "GCSPE", "tipo": "GERENCIA", "codigoIpress": 260, "ipress": "OSPE CAÑETE" },
            { "codigoRed": 12, "red": "HUANCAVELICA", "tipo": "ASISTENCIAL", "codigoIpress": 343, "ipress": "PM ACOBAMBA" },
            { "codigoRed": 12, "red": "HUANCAVELICA", "tipo": "ASISTENCIAL", "codigoIpress": 344, "ipress": "PM CASTROVIRREYNA" },
            { "codigoRed": 12, "red": "HUANCAVELICA", "tipo": "ASISTENCIAL", "codigoIpress": 345, "ipress": "CAP I CHURCAMPA" },
            { "codigoRed": 12, "red": "HUANCAVELICA", "tipo": "ASISTENCIAL", "codigoIpress": 346, "ipress": "CAP I HUAYTARA" },
            { "codigoRed": 12, "red": "HUANCAVELICA", "tipo": "ASISTENCIAL", "codigoIpress": 347, "ipress": "CM LIRCAY" },
            { "codigoRed": 12, "red": "HUANCAVELICA", "tipo": "ASISTENCIAL", "codigoIpress": 348, "ipress": "CM PAMPAS" },
            { "codigoRed": 12, "red": "HUANCAVELICA", "tipo": "ASISTENCIAL", "codigoIpress": 342, "ipress": "HII HUANCAVELICA" },
            { "codigoRed": 13, "red": "HUANUCO", "tipo": "ASISTENCIAL", "codigoIpress": 291, "ipress": "CAP I UCHIZA" },
            { "codigoRed": 13, "red": "HUANUCO", "tipo": "ASISTENCIAL", "codigoIpress": 475, "ipress": "CAP III METROPOLITANO DE HUANUCO" },
            { "codigoRed": 13, "red": "HUANUCO", "tipo": "ASISTENCIAL", "codigoIpress": 298, "ipress": "CM LEONCIO PRADO" },
            { "codigoRed": 13, "red": "HUANUCO", "tipo": "ASISTENCIAL", "codigoIpress": 297, "ipress": "HI TINGO MARIA" },
            { "codigoRed": 13, "red": "HUANUCO", "tipo": "ASISTENCIAL", "codigoIpress": 296, "ipress": "HII HUANUCO" },
            { "codigoRed": 13, "red": "HUANUCO", "tipo": "ASISTENCIAL", "codigoIpress": 299, "ipress": "PM AUCAYACU" },
            { "codigoRed": 13, "red": "HUANUCO", "tipo": "ASISTENCIAL", "codigoIpress": 300, "ipress": "PM BAÑOS" },
            { "codigoRed": 13, "red": "HUANUCO", "tipo": "ASISTENCIAL", "codigoIpress": 303, "ipress": "PM LA UNION" },
            { "codigoRed": 13, "red": "HUANUCO", "tipo": "ASISTENCIAL", "codigoIpress": 304, "ipress": "PM LLATA" },
            { "codigoRed": 13, "red": "HUANUCO", "tipo": "ASISTENCIAL", "codigoIpress": 305, "ipress": "PM PANAO" },
            { "codigoRed": 13, "red": "HUANUCO", "tipo": "ASISTENCIAL", "codigoIpress": 426, "ipress": "PM SANTA LUCIA" },
            { "codigoRed": 13, "red": "HUANUCO", "tipo": "ASISTENCIAL", "codigoIpress": 290, "ipress": "PM TOCACHE" },
            { "codigoRed": 13, "red": "HUANUCO", "tipo": "ASISTENCIAL", "codigoIpress": 302, "ipress": "PM SUNGARO" },
            { "codigoRed": 13, "red": "HUANUCO", "tipo": "ASISTENCIAL", "codigoIpress": 771, "ipress": "CAP III AMARILIS" },
            { "codigoRed": 37, "red": "HUARAZ", "tipo": "ASISTENCIAL", "codigoIpress": 181, "ipress": "CAP II POMABAMBA" },
            { "codigoRed": 37, "red": "HUARAZ", "tipo": "ASISTENCIAL", "codigoIpress": 163, "ipress": "CM CARAZ" },
            { "codigoRed": 37, "red": "HUARAZ", "tipo": "ASISTENCIAL", "codigoIpress": 164, "ipress": "CM CARHUAZ" },
            { "codigoRed": 37, "red": "HUARAZ", "tipo": "ASISTENCIAL", "codigoIpress": 168, "ipress": "CM HUARI" },
            { "codigoRed": 37, "red": "HUARAZ", "tipo": "ASISTENCIAL", "codigoIpress": 162, "ipress": "HII HUARAZ" },
            { "codigoRed": 37, "red": "HUARAZ", "tipo": "ASISTENCIAL", "codigoIpress": 179, "ipress": "PM PISCOBAMBA" },
            { "codigoRed": 37, "red": "HUARAZ", "tipo": "ASISTENCIAL", "codigoIpress": 190, "ipress": "PM YUNGAY" },
            { "codigoRed": 14, "red": "ICA", "tipo": "ASISTENCIAL", "codigoIpress": 50, "ipress": "CAP I CHAVALINA" },
            { "codigoRed": 14, "red": "ICA", "tipo": "ASISTENCIAL", "codigoIpress": 419, "ipress": "CAP I CORACORA" },
            { "codigoRed": 14, "red": "ICA", "tipo": "ASISTENCIAL", "codigoIpress": 54, "ipress": "CAP I PALPA" },
            { "codigoRed": 14, "red": "ICA", "tipo": "ASISTENCIAL", "codigoIpress": 57, "ipress": "CAP I SAN CLEMENTE" },
            { "codigoRed": 14, "red": "ICA", "tipo": "ASISTENCIAL", "codigoIpress": 59, "ipress": "CAP I TAMBO DE MORA" },
            { "codigoRed": 14, "red": "ICA", "tipo": "ASISTENCIAL", "codigoIpress": 61, "ipress": "CAP I VILLA TUPAC AMARU" },
            { "codigoRed": 14, "red": "ICA", "tipo": "ASISTENCIAL", "codigoIpress": 371, "ipress": "CAP II LA TINGUIÑA" },
            { "codigoRed": 14, "red": "ICA", "tipo": "ASISTENCIAL", "codigoIpress": 52, "ipress": "CAP II MACACONA" },
            { "codigoRed": 14, "red": "ICA", "tipo": "ASISTENCIAL", "codigoIpress": 53, "ipress": "CAP II NASCA" },
            { "codigoRed": 14, "red": "ICA", "tipo": "ASISTENCIAL", "codigoIpress": 424, "ipress": "CAP II PUEBLO NUEVO" },
            { "codigoRed": 14, "red": "ICA", "tipo": "ASISTENCIAL", "codigoIpress": 56, "ipress": "CAP II PUQUIO" },
            { "codigoRed": 14, "red": "ICA", "tipo": "ASISTENCIAL", "codigoIpress": 58, "ipress": "CAP II SANTA MARGARITA" },
            { "codigoRed": 14, "red": "ICA", "tipo": "ASISTENCIAL", "codigoIpress": 48, "ipress": "HI ANTONIO SKRABONJA ANTONCICH" },
            { "codigoRed": 14, "red": "ICA", "tipo": "ASISTENCIAL", "codigoIpress": 45, "ipress": "HI FELIX TORREALVA GUTIERREZ" },
            { "codigoRed": 14, "red": "ICA", "tipo": "ASISTENCIAL", "codigoIpress": 47, "ipress": "HI MARIA REICHE NEUMAN" },
            { "codigoRed": 14, "red": "ICA", "tipo": "ASISTENCIAL", "codigoIpress": 46, "ipress": "HII RENE TOCHE GROPPO" },
            { "codigoRed": 14, "red": "ICA", "tipo": "ASISTENCIAL", "codigoIpress": 506, "ipress": "HIV AUGUSTO HERNANDEZ MENDOZA" },
            { "codigoRed": 41, "red": "INSTITUTO NACIONAL CARDIOVASCULAR", "tipo": "CENTRO ESPECIALIZADO", "codigoIpress": 392, "ipress": "INCOR" },
            { "codigoRed": 42, "red": "CENTRO NACIONAL DE SALUD RENAL", "tipo": "CENTRO ESPECIALIZADO", "codigoIpress": 401, "ipress": "CNSR" },
            { "codigoRed": 38, "red": "JAEN", "tipo": "ASISTENCIAL", "codigoIpress": 256, "ipress": "CAP II SAN IGNACIO" },
            { "codigoRed": 38, "red": "JAEN", "tipo": "ASISTENCIAL", "codigoIpress": 245, "ipress": "HII JAEN" },
            { "codigoRed": 38, "red": "JAEN", "tipo": "ASISTENCIAL", "codigoIpress": 255, "ipress": "PM PUCARA" },
            { "codigoRed": 34, "red": "JULIACA", "tipo": "ASISTENCIAL", "codigoIpress": 490, "ipress": "CAP I ASILLO" },
            { "codigoRed": 34, "red": "JULIACA", "tipo": "ASISTENCIAL", "codigoIpress": 491, "ipress": "CAP II CABANILLAS" },
            { "codigoRed": 34, "red": "JULIACA", "tipo": "ASISTENCIAL", "codigoIpress": 519, "ipress": "CAP III ENRIQUE ENCINAS FRANCO" },
            { "codigoRed": 34, "red": "JULIACA", "tipo": "ASISTENCIAL", "codigoIpress": 142, "ipress": "CM AYAVIRI" },
            { "codigoRed": 34, "red": "JULIACA", "tipo": "ASISTENCIAL", "codigoIpress": 141, "ipress": "HI LAMPA" },
            { "codigoRed": 34, "red": "JULIACA", "tipo": "ASISTENCIAL", "codigoIpress": 139, "ipress": "HIII JULIACA" },
            { "codigoRed": 34, "red": "JULIACA", "tipo": "ASISTENCIAL", "codigoIpress": 144, "ipress": "PM HUANCANE" },
            { "codigoRed": 34, "red": "JULIACA", "tipo": "ASISTENCIAL", "codigoIpress": 420, "ipress": "PM SAN GABAN" },
            { "codigoRed": 34, "red": "JULIACA", "tipo": "ASISTENCIAL", "codigoIpress": 146, "ipress": "PM SAN RAFAEL" },
            { "codigoRed": 34, "red": "JULIACA", "tipo": "ASISTENCIAL", "codigoIpress": 147, "ipress": "PM SANDIA" },
            { "codigoRed": 34, "red": "JULIACA", "tipo": "ASISTENCIAL", "codigoIpress": 143, "ipress": "POL AZANGARO" },
            { "codigoRed": 34, "red": "JULIACA", "tipo": "ASISTENCIAL", "codigoIpress": 413, "ipress": "POL JULIACA" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 492, "ipress": "CAP I PICHANAQUI" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 454, "ipress": "CAP II CHILCA" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 504, "ipress": "CAP II CHUPACA" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 317, "ipress": "CAP II JUNIN" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 320, "ipress": "CAP II MOROCOCHA" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 494, "ipress": "CAP III MANTARO" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 312, "ipress": "CM CONCEPCION" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 313, "ipress": "HI DE LA SELVA CENTRAL Y ENF. TROP." },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 309, "ipress": "HI RIO NEGRO - SATIPO" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 310, "ipress": "HI TARMA" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 308, "ipress": "HII ALBERTO HURTADO ABADIA" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 307, "ipress": "HN RAMIRO PRIALE PRIALE" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 316, "ipress": "PM CORPACANCHA" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 314, "ipress": "PM ANDAYCHAGUA" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 315, "ipress": "PM COBRIZA" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 318, "ipress": "PM MARH-TUNEL" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 322, "ipress": "PM PACHACAYO" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 323, "ipress": "PM SAN CRISTOBAL" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 372, "ipress": "PM SAN PEDRO DE CAJAS" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 324, "ipress": "PM YAURICOCHA" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 311, "ipress": "POL JAUJA" },
            { "codigoRed": 15, "red": "JUNIN", "tipo": "ASISTENCIAL", "codigoIpress": 431, "ipress": "POL METROPOLITANO HUANCAYO" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 220, "ipress": "CAP I CHICAMA" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 228, "ipress": "CAP I MALABRIGO" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 231, "ipress": "CAP I SALAVERRY" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 223, "ipress": "CAP II GUADALUPE" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 224, "ipress": "CAP II HUAMACHUCO" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 226, "ipress": "CAP II LAREDO" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 229, "ipress": "CAP II OTUZCO" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 239, "ipress": "CAP II SOLEDAD" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 240, "ipress": "CAP II TAYABAMBA" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 484, "ipress": "CAP III METROPOLITANO DE TRUJILLO" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 209, "ipress": "CM ASCOPE" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 429, "ipress": "CME CASA GRANDE" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 442, "ipress": "CM HUANCHACO" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 241, "ipress": "H VICTOR SOLES GARCIA - VIRU" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 207, "ipress": "HI ALBRECHT" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 211, "ipress": "HI FLORENCIA DE MORA" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 212, "ipress": "HI LA ESPERANZA" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 213, "ipress": "HI MOCHE" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 219, "ipress": "CAP I CASCAS" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 208, "ipress": "HI PACASMAYO" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 206, "ipress": "HII CHOCOPE" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 205, "ipress": "HIV VICTOR LAZARTE ECHEGARAY" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 671, "ipress": "HN VIRGEN DE LA PUERTA" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 444, "ipress": "PM CHAO" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 227, "ipress": "PM LIMONCARRO" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 225, "ipress": "PM JEQUETEPEQUE" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 230, "ipress": "PM QUIRUVILCA" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 233, "ipress": "PM SAN JOSE" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 235, "ipress": "CAP I SAN PEDRO DE LLOC" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 236, "ipress": "PM SANTIAGO DE CHUCO" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 210, "ipress": "POL EL PORVENIR" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 237, "ipress": "PM SAUSAL" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 218, "ipress": "PM CARTAVIO" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 432, "ipress": "PM PAIJAN" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 433, "ipress": "PM SANTIAGO DE CAO" },
            { "codigoRed": 16, "red": "LA LIBERTAD", "tipo": "ASISTENCIAL", "codigoIpress": 443, "ipress": "POL VICTOR LARCO HERRERA" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 249, "ipress": "CAP II CHONGOYAPE" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 251, "ipress": "CAP II JAYANCA" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 252, "ipress": "CAP II MOTUPE" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 493, "ipress": "CAP II PATAPO" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 383, "ipress": "CAP III CARLOS CASTAÑEDA IPARRAGUIRRE" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 248, "ipress": "CAP III MANUEL MANRIQUE NEVADO" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 243, "ipress": "CM CAYALTI" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 194, "ipress": "CM CHOTA" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 195, "ipress": "CM CUTERVO" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 250, "ipress": "CM JUAN AITA VALLE" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 242, "ipress": "HI AGUSTIN ARBULU NEYRA" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 244, "ipress": "HI CHEPEN" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 740, "ipress": "HI CLINICO TUMAN" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 402, "ipress": "HI NAYLAMP" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 496, "ipress": "HII LUIS ENRIQUE HEYSEN INCHAUSTEGUI" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 4, "ipress": "HN ALMANZOR AGUINAGA ASENJO" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 253, "ipress": "PM OLMOS" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 254, "ipress": "PM OYOTUN" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 257, "ipress": "PM SANTA CRUZ" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 259, "ipress": "PM TUCUME" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 260, "ipress": "PM UCUPE" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 384, "ipress": "POL AGUSTIN GAVIDIA SALCEDO" },
            { "codigoRed": 17, "red": "LAMBAYEQUE", "tipo": "PRESTACIONAL", "codigoIpress": 370, "ipress": "POL CHICLAYO OESTE" },
            { "codigoRed": 19, "red": "LORETO", "tipo": "ASISTENCIAL", "codigoIpress": 64, "ipress": "CAP II CABALLOCOCHA" },
            { "codigoRed": 19, "red": "LORETO", "tipo": "ASISTENCIAL", "codigoIpress": 65, "ipress": "CAP II NAUTA" },
            { "codigoRed": 19, "red": "LORETO", "tipo": "ASISTENCIAL", "codigoIpress": 66, "ipress": "CAP II REQUENA" },
            { "codigoRed": 19, "red": "LORETO", "tipo": "ASISTENCIAL", "codigoIpress": 441, "ipress": "CAP II SAN JUAN BAUTISTA" },
            { "codigoRed": 19, "red": "LORETO", "tipo": "ASISTENCIAL", "codigoIpress": 439, "ipress": "CAP III IQUITOS" },
            { "codigoRed": 19, "red": "LORETO", "tipo": "ASISTENCIAL", "codigoIpress": 440, "ipress": "CAP III PUNCHANA" },
            { "codigoRed": 19, "red": "LORETO", "tipo": "ASISTENCIAL", "codigoIpress": 63, "ipress": "HI YURIMAGUAS" },
            { "codigoRed": 19, "red": "LORETO", "tipo": "ASISTENCIAL", "codigoIpress": 62, "ipress": "HIII IQUITOS" },
            { "codigoRed": 19, "red": "LORETO", "tipo": "ASISTENCIAL", "codigoIpress": 518, "ipress": "CAP I SAN ANTONIO DEL ESTRECHO" },
            { "codigoRed": 20, "red": "MADRE DE DIOS", "tipo": "ASISTENCIAL", "codigoIpress": 127, "ipress": "HI VICTOR ALFREDO LAZO PERALTA" },
            { "codigoRed": 20, "red": "MADRE DE DIOS", "tipo": "ASISTENCIAL", "codigoIpress": 129, "ipress": "PM IBERIA" },
            { "codigoRed": 20, "red": "MADRE DE DIOS", "tipo": "ASISTENCIAL", "codigoIpress": 132, "ipress": "PM MAZUKO" },
            { "codigoRed": 21, "red": "MOQUEGUA", "tipo": "ASISTENCIAL", "codigoIpress": 474, "ipress": "CAP II TORATA" },
            { "codigoRed": 21, "red": "MOQUEGUA", "tipo": "ASISTENCIAL", "codigoIpress": 681, "ipress": "CM PAMPA INALAMBRICA" },
            { "codigoRed": 21, "red": "MOQUEGUA", "tipo": "ASISTENCIAL", "codigoIpress": 680, "ipress": "CM SAMEGUA" },
            { "codigoRed": 21, "red": "MOQUEGUA", "tipo": "ASISTENCIAL", "codigoIpress": 135, "ipress": "HII ILO" },
            { "codigoRed": 21, "red": "MOQUEGUA", "tipo": "ASISTENCIAL", "codigoIpress": 136, "ipress": "HII MOQUEGUA" },
            { "codigoRed": 21, "red": "MOQUEGUA", "tipo": "ASISTENCIAL", "codigoIpress": 137, "ipress": "PM OMATE" },
            { "codigoRed": 35, "red": "MOYOBAMBA", "tipo": "ASISTENCIAL", "codigoIpress": 489, "ipress": "CAP I NUEVA CAJAMARCA" },
            { "codigoRed": 35, "red": "MOYOBAMBA", "tipo": "ASISTENCIAL", "codigoIpress": 281, "ipress": "HI ALTO MAYO" },
            { "codigoRed": 35, "red": "MOYOBAMBA", "tipo": "ASISTENCIAL", "codigoIpress": 282, "ipress": "HI RIOJA" },
            { "codigoRed": 36, "red": "OFERTA FLEXIBLE", "tipo": "GERENCIA", "codigoIpress": 396, "ipress": "PADOMI" },
            { "codigoRed": 22, "red": "PASCO", "tipo": "ASISTENCIAL", "codigoIpress": 332, "ipress": "CAP II HUAYLLAY" },
            { "codigoRed": 22, "red": "PASCO", "tipo": "ASISTENCIAL", "codigoIpress": 340, "ipress": "CAP II VILLA RICA" },
            { "codigoRed": 22, "red": "PASCO", "tipo": "ASISTENCIAL", "codigoIpress": 341, "ipress": "CAP II YANAHUANCA" },
            { "codigoRed": 22, "red": "PASCO", "tipo": "ASISTENCIAL", "codigoIpress": 338, "ipress": "CM SAN JUAN" },
            { "codigoRed": 22, "red": "PASCO", "tipo": "ASISTENCIAL", "codigoIpress": 326, "ipress": "HI HUARIACA" },
            { "codigoRed": 22, "red": "PASCO", "tipo": "ASISTENCIAL", "codigoIpress": 334, "ipress": "HI OXAPAMPA" },
            { "codigoRed": 22, "red": "PASCO", "tipo": "ASISTENCIAL", "codigoIpress": 325, "ipress": "HII CERRO DE PASCO" },
            { "codigoRed": 22, "red": "PASCO", "tipo": "ASISTENCIAL", "codigoIpress": 329, "ipress": "PM CHICRIN" },
            { "codigoRed": 22, "red": "PASCO", "tipo": "ASISTENCIAL", "codigoIpress": 330, "ipress": "PM COLQUIJIRCA" },
            { "codigoRed": 22, "red": "PASCO", "tipo": "ASISTENCIAL", "codigoIpress": 333, "ipress": "PM MILPO" },
            { "codigoRed": 22, "red": "PASCO", "tipo": "ASISTENCIAL", "codigoIpress": 335, "ipress": "PM PAUCARTAMBO" },
            { "codigoRed": 22, "red": "PASCO", "tipo": "ASISTENCIAL", "codigoIpress": 336, "ipress": "PM POZUZO" },
            { "codigoRed": 22, "red": "PASCO", "tipo": "ASISTENCIAL", "codigoIpress": 337, "ipress": "PM PUERTO BERMUDEZ" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 269, "ipress": "CAP II CHULUCANAS" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 266, "ipress": "CAP III CASTILLA" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 488, "ipress": "CAP III CATACAOS" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 517, "ipress": "CAP III METROPOLITANO DE PIURA" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 273, "ipress": "CM LEONCIO AMAYA TUME" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 278, "ipress": "CM TAMBOGRANDE" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 262, "ipress": "HI MIGUEL CRUZADO VERA (PAITA)" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 263, "ipress": "HI SULLANA" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 265, "ipress": "HII JORGE REATEGUI DELGADO" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 264, "ipress": "HII TALARA" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 261, "ipress": "HIII CAYETANO HEREDIA" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 382, "ipress": "INSTITUTO PERUANO DE OFTALMOLOGIA" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 817, "ipress": "IPRESS HOSPITAL PRIVADO PERU" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 825, "ipress": "IPRESS HOSPITAL UNIVERSITARIO" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 827, "ipress": "IPRESS INMACULADA" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 267, "ipress": "PM AYABACA" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 268, "ipress": "PM CANCHAQUE" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 271, "ipress": "PM HUANCABAMBA" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 272, "ipress": "PM IGNACIO ESCUDERO" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 274, "ipress": "PM LOS ORGANOS" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 275, "ipress": "PM MORROPON" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 276, "ipress": "PM NEGRITOS" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 380, "ipress": "CM EL ALTO" },
            { "codigoRed": 23, "red": "PIURA", "tipo": "ASISTENCIAL", "codigoIpress": 277, "ipress": "PM SECHURA" },
            { "codigoRed": 24, "red": "PUNO", "tipo": "ASISTENCIAL", "codigoIpress": 452, "ipress": "CAP II ACORA" },
            { "codigoRed": 24, "red": "PUNO", "tipo": "ASISTENCIAL", "codigoIpress": 414, "ipress": "CAP III METROPOLITANO DE PUNO" },
            { "codigoRed": 24, "red": "PUNO", "tipo": "ASISTENCIAL", "codigoIpress": 421, "ipress": "HI CLINICA UNIVERSITARIA UNA-ESSALUD" },
            { "codigoRed": 24, "red": "PUNO", "tipo": "ASISTENCIAL", "codigoIpress": 386, "ipress": "POL ILAVE" },
            { "codigoRed": 24, "red": "PUNO", "tipo": "ASISTENCIAL", "codigoIpress": 145, "ipress": "PM JULI" },
            { "codigoRed": 24, "red": "PUNO", "tipo": "ASISTENCIAL", "codigoIpress": 148, "ipress": "PM YUNGUYO" },
            { "codigoRed": 24, "red": "PUNO", "tipo": "ASISTENCIAL", "codigoIpress": 451, "ipress": "CAP I DESAGUADERO" },
            { "codigoRed": 24, "red": "PUNO", "tipo": "ASISTENCIAL", "codigoIpress": 140, "ipress": "HIII PUNO" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 450, "ipress": "CAP II LURIN" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 476, "ipress": "CAP III SAN ISIDRO" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 500, "ipress": "CAP III SAN JUAN DE MIRAFLORES" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 477, "ipress": "CAP III SURQUILLO" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 498, "ipress": "CEDHI" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 39, "ipress": "CM MALA" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 408, "ipress": "HI CARLOS ALCANTARA BUTERFIELD" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 405, "ipress": "HI ULDARICO ROCCA FERNANDEZ" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 38, "ipress": "HII CAÑETE" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 6, "ipress": "HIII SUAREZ-ANGAMOS" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 1, "ipress": "HN EDGARDO REBAGLIATI MARTINS" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 10, "ipress": "POL CHINCHA" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 407, "ipress": "POL JUAN JOSE RODRIGUEZ LAZO" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 21, "ipress": "POL PABLO BERMUDEZ" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 16, "ipress": "POL PROCERES" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 436, "ipress": "POL SANTA CRUZ" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 527, "ipress": "H ESP GUILLERMO KAELIN" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 525, "ipress": "POL GUILLERMO KAELIN" },
            { "codigoRed": 1, "red": "REBAGLIATI", "tipo": "PRESTACIONAL", "codigoIpress": 781, "ipress": "HOSPITAL MODULAR DE ESPECIALIDADES QUIRÚRGICAS SAN JUAN DE MIRAFLORES" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 31, "ipress": "CAP II CHANCAY" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 30, "ipress": "CAP II PARAMONGA" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 36, "ipress": "CAP II SAYAN" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 473, "ipress": "CAP III CARABAYLLO" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 409, "ipress": "CAP III HNA MARIA DONROSE SUTMOLLER" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 32, "ipress": "CAP III HUARAL" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 497, "ipress": "CAP III LUIS NEGREIROS" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 486, "ipress": "CAP III METROPOLITANO DEL CALLAO" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 29, "ipress": "CAP III PEDRO REYES BARBOZA" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 455, "ipress": "CAP III PUENTE PIEDRA" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 673, "ipress": "CEVIT HUACHO" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 410, "ipress": "HI MARINO MOLINA SCIPPA" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 412, "ipress": "HI OCTAVIO MONGRUT MUÑOZ" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 15, "ipress": "HII LIMA NORTE-CALLAO LUIS NEGREIROS VEGA" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 5, "ipress": "HN ALBERTO SABOGAL SOLOGUREN" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 28, "ipress": "HII GUSTAVO LANATTA LUJAN" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 33, "ipress": "PM HUMAYA" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 37, "ipress": "PM OYON" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 13, "ipress": "POL FIORI" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 679, "ipress": "POL RETABLO-COMAS" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 528, "ipress": "H ESP ALBERTO LEOPOLDO BARTON" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 526, "ipress": "POL ALBERTO LEOPOLDO BARTON" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 780, "ipress": "HOSPITAL DE ESPECIALIDADES QUIRURGICAS CANTA–CALLAO" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 802, "ipress": "IPRESS PROLIMA" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 818, "ipress": "IPRESS VILLASOL" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 819, "ipress": "IPRESS EL TREBOL" },
            { "codigoRed": 3, "red": "SABOGAL", "tipo": "PRESTACIONAL", "codigoIpress": 852, "ipress": "IPRESS HOSPITAL MUNICIPAL LOS OLIVOS" },
            { "codigoRed": 26, "red": "TACNA", "tipo": "ASISTENCIAL", "codigoIpress": 435, "ipress": "CAP I ILABAYA" },
            { "codigoRed": 26, "red": "TACNA", "tipo": "ASISTENCIAL", "codigoIpress": 434, "ipress": "CAP I ITE" },
            { "codigoRed": 26, "red": "TACNA", "tipo": "ASISTENCIAL", "codigoIpress": 152, "ipress": "CAP I TARATA" },
            { "codigoRed": 26, "red": "TACNA", "tipo": "ASISTENCIAL", "codigoIpress": 150, "ipress": "CAP II LUIS PALZA LEVANO" },
            { "codigoRed": 26, "red": "TACNA", "tipo": "ASISTENCIAL", "codigoIpress": 448, "ipress": "CAP II OSCAR FERNANDEZ DAVILA VELEZ" },
            { "codigoRed": 26, "red": "TACNA", "tipo": "ASISTENCIAL", "codigoIpress": 430, "ipress": "CAP III METROPOLITANO DE TACNA" },
            { "codigoRed": 26, "red": "TACNA", "tipo": "ASISTENCIAL", "codigoIpress": 149, "ipress": "HIII DANIEL ALCIDES CARRION" },
            { "codigoRed": 26, "red": "TACNA", "tipo": "ASISTENCIAL", "codigoIpress": 151, "ipress": "PM LOCUMBA" },
            { "codigoRed": 25, "red": "TARAPOTO", "tipo": "ASISTENCIAL", "codigoIpress": 280, "ipress": "HI JUANJUI" },
            { "codigoRed": 25, "red": "TARAPOTO", "tipo": "ASISTENCIAL", "codigoIpress": 279, "ipress": "HII TARAPOTO" },
            { "codigoRed": 25, "red": "TARAPOTO", "tipo": "ASISTENCIAL", "codigoIpress": 285, "ipress": "PM BELLAVISTA" },
            { "codigoRed": 25, "red": "TARAPOTO", "tipo": "ASISTENCIAL", "codigoIpress": 286, "ipress": "PM LAMAS" },
            { "codigoRed": 25, "red": "TARAPOTO", "tipo": "ASISTENCIAL", "codigoIpress": 289, "ipress": "PM SAPOSOA" },
            { "codigoRed": 25, "red": "TARAPOTO", "tipo": "ASISTENCIAL", "codigoIpress": 709, "ipress": "CM METROPOLITANO" },
            { "codigoRed": 27, "red": "TUMBES", "tipo": "ASISTENCIAL", "codigoIpress": 292, "ipress": "HI CARLOS ALBERTO CORTEZ JIMENEZ" },
            { "codigoRed": 27, "red": "TUMBES", "tipo": "ASISTENCIAL", "codigoIpress": 293, "ipress": "PM LA CRUZ" },
            { "codigoRed": 27, "red": "TUMBES", "tipo": "ASISTENCIAL", "codigoIpress": 381, "ipress": "PM ZARUMILLA" },
            { "codigoRed": 27, "red": "TUMBES", "tipo": "ASISTENCIAL", "codigoIpress": 294, "ipress": "PM ZORRITOS" },
            { "codigoRed": 28, "red": "UCAYALI", "tipo": "ASISTENCIAL", "codigoIpress": 349, "ipress": "HII PUCALLPA" },
            { "codigoRed": 28, "red": "UCAYALI", "tipo": "ASISTENCIAL", "codigoIpress": 350, "ipress": "PM AGUAYTIA" },
            { "codigoRed": 28, "red": "UCAYALI", "tipo": "ASISTENCIAL", "codigoIpress": 351, "ipress": "PM ALAMEDA" },
            { "codigoRed": 28, "red": "UCAYALI", "tipo": "ASISTENCIAL", "codigoIpress": 352, "ipress": "PM ATALAYA" },
            { "codigoRed": 28, "red": "UCAYALI", "tipo": "ASISTENCIAL", "codigoIpress": 355, "ipress": "PM CONTAMANA" },
            { "codigoRed": 28, "red": "UCAYALI", "tipo": "ASISTENCIAL", "codigoIpress": 503, "ipress": "CAP I CAMPOVERDE" },
            { "codigoRed": 28, "red": "UCAYALI", "tipo": "ASISTENCIAL", "codigoIpress": 515, "ipress": "CAP I MANANTAY" }
        ];

        const auditoresPorRed = {
            'maria.delgadom@essalud.gob.pe': ['CAJAMARCA', 'GCSPE', 'CUSCO', 'ICA', 'SABOGAL', 'TARAPOTO'],
            'monica.echarry@essalud.gob.pe': ['AMAZONAS', 'AYACUCHO', 'HUANUCO', 'LAMBAYEQUE', 'REBAGLIATI', 'TUMBES'],
            'kathia.vega@essalud.gob.pe': ['AREQUIPA'],
            'jeannette.motta@essalud.gob.pe': ['ANCASH', 'JUNIN', 'PASCO', 'PIURA'],
            'yohny.torres@essalud.gob.pe': ['APURIMAC', 'OFERTA FLEXIBLE', 'LORETO', 'MOQUEGUA', 'PUNO', 'UCAYALI'],
            'ruben.pena@essalud.gob.pe': ['INSTITUTO NACIONAL CARDIOVASCULAR', 'CENTRO NACIONAL DE SALUD RENAL', 'MADRE DE DIOS', 'MOYOBAMBA'],
            'david.romero@essalud.gob.pe': ['ALMENARA', 'HUANCAVELICA', 'JULIACA', 'LA LIBERTAD', 'TACNA', 'JAEN', 'HUARAZ']
        };

        function actualizarIpress() {
            const redSeleccionada = document.getElementById('red').value;
            const ipressSelect = document.getElementById('ipress');
            ipressSelect.innerHTML = '<option value="">Seleccione una IPRESS</option>';
            if (redSeleccionada) {
                const ipressFiltradas = datosExcel.filter(item => item.red === redSeleccionada);
                const ipressUnicas = [...new Set(ipressFiltradas.map(item => item.ipress))].sort();
                ipressUnicas.forEach(ipress => ipressSelect.add(new Option(ipress, ipress)));
            }
            document.getElementById('tipo').value = '';
            document.getElementById('codigoIpress').value = '';
            actualizarAuditor();
        }

        function asignarCodigoIpress() {
            const ipressSeleccionada = document.getElementById('ipress').value;
            const redSeleccionada = document.getElementById('red').value;
            const item = datosExcel.find(d => d.red === redSeleccionada && d.ipress === ipressSeleccionada);
            document.getElementById('tipo').value = item ? item.tipo : '';
            document.getElementById('codigoIpress').value = item ? item.codigoIpress : '';
            actualizarAuditor();
        }

        function actualizarAuditor() {
            const redSeleccionada = document.getElementById('red').value;
            const ipressSeleccionada = document.getElementById('ipress').value;
            const auditorInput = document.getElementById('auditor');
            if (redSeleccionada === 'GCSPE') {
                if (ipressSeleccionada === 'CEVIT CENTRAL') {
                    auditorInput.value = 'maria.delgadom@essalud.gob.pe';
                } else if (ipressSeleccionada) {
                    auditorInput.value = 'william.arana@essalud.gob.pe';
                } else {
                    auditorInput.value = 'maria.delgadom@essalud.gob.pe';
                }
            } else {
                asignarAuditorPorRed(redSeleccionada);
            }
        }

        function asignarAuditorPorRed(redSeleccionada) {
            let auditorAsignado = '';
            for (const auditor in auditoresPorRed) {
                if (auditoresPorRed[auditor].includes(redSeleccionada)) {
                    auditorAsignado = auditor;
                    break;
                }
            }
            document.getElementById('auditor').value = auditorAsignado;
        }

        function padearDocumento(input) {
            const tipo = document.getElementById('tipoDoc').value;
            const longitud = tipo === 'DNI' ? 8 : 12; // CE puede tener hasta 12
            let valor = input.value.replace(/\D/g, '');
            if (valor && tipo === 'DNI') {
                input.value = valor.padStart(longitud, '0');
            }
        }

        function padearConCeros(input, longitud) {
            let valor = input.value.replace(/\D/g, '');
            if (valor) {
                input.value = valor.padStart(longitud, '0');
            }
        }

        function togglePlanilla(checkbox) {
            const inputPlanilla = document.getElementById('codigoPlanilla');
            const formGroup = inputPlanilla.closest('.form-group');
            if (checkbox.checked) {
                inputPlanilla.value = 'PERSONAL DE IPRESS EXTERNA';
                inputPlanilla.readOnly = true;
                inputPlanilla.required = false;
                inputPlanilla.dispatchEvent(new Event('input'));
            } else {
                inputPlanilla.value = '';
                inputPlanilla.readOnly = false;
                inputPlanilla.required = true;
            }
        }
        
        function toggleCorreoInstitucional(checkbox) {
            const inputCorreo = document.getElementById('correoInstitucional');
            if (checkbox.checked) {
                inputCorreo.placeholder = 'usuario@dominio.com';
                inputCorreo.setAttribute('list', 'personal-domains');
            } else {
                inputCorreo.placeholder = 'usuario@essalud.gob.pe';
                inputCorreo.setAttribute('list', 'institutional-domains');
            }
            inputCorreo.value = '';
            inputCorreo.dispatchEvent(new Event('input'));
        }
        
        function calcularDuracion(fechaInicio, fechaFin) {
                    let inicio = new Date(fechaInicio);
                    let fin = new Date(fechaFin);
                    inicio.setMinutes(inicio.getMinutes() + inicio.getTimezoneOffset());
                    fin.setMinutes(fin.getMinutes() + fin.getTimezoneOffset());
                    let anios = fin.getFullYear() - inicio.getFullYear();
                    let meses = fin.getMonth() - inicio.getMonth();
                    let dias = fin.getDate() - inicio.getDate();
                    if (dias < 0) {
                        meses--;
                        dias += new Date(fin.getFullYear(), fin.getMonth(), 0).getDate();
                    }
                    if (meses < 0) {
                        anios--;
                        meses += 12;
                    }
                    return { anios, meses, dias };
                }
        function validarFechas() {
            const emisionInput = document.getElementById('fechaEmision');
            const terminoInput = document.getElementById('fechaTermino');
            const duracionDiv = document.getElementById('duracionVigencia');
            const emision = emisionInput.value;
            const termino = terminoInput.value;
            duracionDiv.textContent = '';
            if (emision && termino) {
                if (new Date(termino) < new Date(emision)) {
                    alert('La fecha de término de vigencia no puede ser anterior a la fecha de emisión.');
                    terminoInput.value = '';
                } else {
                    const duracion = calcularDuracion(emision, termino);
                    let textoDuracion = 'Duración de la vigencia: ';
                    if (duracion.anios > 0) textoDuracion += `${duracion.anios} año(s) `;
                    if (duracion.meses > 0) textoDuracion += `${duracion.meses} mes(es) `;
                    if (duracion.dias >= 0) textoDuracion += `${duracion.dias} día(s)`;
                    duracionDiv.textContent = textoDuracion.trim();
                }
            }
        }
        function limpiarFormulario() {
            document.getElementById('formulario').reset();
            const ipressSelect = document.getElementById('ipress');
            ipressSelect.innerHTML = '<option value="">Seleccione una IPRESS</option>';
            document.getElementById('tipo').value = '';
            document.getElementById('codigoIpress').value = '';
            document.getElementById('auditor').value = '';
            document.getElementById('duracionVigencia').textContent = '';
            document.getElementById('tipoDoc').dispatchEvent(new Event('change'));
            togglePlanilla(document.getElementById('esExterna'));
            if(document.getElementById('noCorreoInstitucional').checked) {
                toggleCorreoInstitucional(document.getElementById('noCorreoInstitucional'));
            }
        }
        
        function validarFormulario() {
            const form = document.getElementById('formulario');
            if (!form.checkValidity()) {
                alert('Por favor, complete todos los campos requeridos marcados con un asterisco.');
                form.reportValidity();
                return false;
            }
            const telefono = document.getElementById('telefono').value;
            if (!/^9\d{8}$/.test(telefono)) {
                alert('Error en TELÉFONO PERSONAL: Debe empezar con 9 y tener 9 dígitos.');
                return false;
            }
            const correoInstitucional = document.getElementById('correoInstitucional').value;
            const noCorreoCheckbox = document.getElementById('noCorreoInstitucional');
            if (!noCorreoCheckbox.checked && !/.+@essalud\.gob\.pe$/.test(correoInstitucional)) {
                alert('Error en CORREO INSTITUCIONAL: Debe terminar en @essalud.gob.pe o marque la casilla "Sin correo @essalud.gob.pe".');
                return false;
            }
            const correoParticular = document.getElementById('correoParticular').value;
            if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(correoParticular)) {
                alert('Error en CORREO PARTICULAR: El formato no es válido.');
                return false;
            }
            return true;
        }

        // MEJORA 1a: Se elimina el alert('Procesando...') y se añade el indicador de carga
        function guardarDatos() {
            if (!validarFormulario()) { return; }
            
            const btnGuardar = document.getElementById('btn-guardar');
            btnGuardar.disabled = true;
            btnGuardar.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Guardando...';

            const formData = {
                red: document.getElementById('red').value,
                ipress: document.getElementById('ipress').value,
                codigoIpress: document.getElementById('codigoIpress').value,
                apellidos: document.getElementById('apellidos').value,
                nombres: document.getElementById('nombres').value,
                tipoDoc: document.getElementById('tipoDoc').value,
                numeroDoc: document.getElementById('numeroDoc').value,
                cargo: document.getElementById('cargo').value,
                profesional: document.getElementById('profesional').value,
                codigoPlanilla: document.getElementById('codigoPlanilla').value,
                colegiatura: document.getElementById('colegiatura').value,
                numResolucion: document.getElementById('numResolucion').value,
                fechaEmision: document.getElementById('fechaEmision').value,
                fechaTermino: document.getElementById('fechaTermino').value,
                telefono: document.getElementById('telefono').value,
                correoInstitucional: document.getElementById('correoInstitucional').value,
                correoParticular: document.getElementById('correoParticular').value,
                solicitud: document.getElementById('solicitud').value,
                auditor: document.getElementById('auditor').value
            };
            const file = document.getElementById('archivo').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    formData.archivoBase64 = e.target.result.split(',')[1];
                    formData.archivoMime = file.type;
                    formData.archivoNombre = file.name;
                    enviarAGoogle(formData);
                };
                reader.readAsDataURL(file);
            } else {
                enviarAGoogle(formData);
            }
        }

        // MEJORA 2a: Se centraliza el uso de la URL
        function enviarAGoogle(data) {
            const btnGuardar = document.getElementById('btn-guardar');
            fetch(SHEETS_API_URL, {
                method: 'POST',
                cache: 'no-cache',
                redirect: 'follow',
                headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                body: JSON.stringify(data) 
            })
            .then(res => res.json())
            .then(response => {
                console.log('Success:', response);
                alert('¡Registro grabado satisfactoriamente! Se ha enviado una copia a los correos registrados.');
                limpiarFormulario();
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error al guardar el registro. Revise la consola para más detalles.');
            })
            .finally(() => { // MEJORA 1a: Se restaura el botón al finalizar
                btnGuardar.disabled = false;
                btnGuardar.innerHTML = 'Guardar';
            });
        }
        
        function updateEmailDatalist(input, datalistId) {
            const datalist = document.getElementById(datalistId);
            const currentValue = input.value;
            if (currentValue.includes('@')) {
                const alias = currentValue.split('@')[0];
                const originalOptions = Array.from(datalist.options).map(opt => opt.value);
                datalist.innerHTML = '';
                originalOptions.forEach(domain => {
                    const newOption = document.createElement('option');
                    newOption.value = alias + domain;
                    datalist.appendChild(newOption);
                });
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            const redSelect = document.getElementById('red');
            const redesUnicas = [...new Set(datosExcel.map(item => item.red))].sort();
            redesUnicas.forEach(red => redSelect.add(new Option(red, red)));

            function actualizarPlaceholderDoc() {
                const tipoDocSelect = document.getElementById('tipoDoc');
                const numeroDocInput = document.getElementById('numeroDoc');
                numeroDocInput.placeholder = (tipoDocSelect.value === 'DNI') ? '8 dígitos' : 'Hasta 12 dígitos';
            }
            document.getElementById('tipoDoc').addEventListener('change', actualizarPlaceholderDoc);
            actualizarPlaceholderDoc();
            
            // MEJORA 1b: Validación de Fechas Proactiva
            document.getElementById('fechaEmision').addEventListener('change', function() {
                const fechaTerminoInput = document.getElementById('fechaTermino');
                if (this.value) {
                    fechaTerminoInput.min = this.value;
                    // Si la fecha de término ya seleccionada es inválida, la reseteamos
                    if (fechaTerminoInput.value && fechaTerminoInput.value < this.value) {
                        fechaTerminoInput.value = '';
                    }
                }
            });

            const codigoPlanillaInput = document.getElementById('codigoPlanilla');
            const esExternaCheckbox = document.getElementById('esExterna');
            if (codigoPlanillaInput) {
                codigoPlanillaInput.addEventListener('input', () => {
                    if (!esExternaCheckbox.checked) {
                        codigoPlanillaInput.value = codigoPlanillaInput.value.replace(/\D/g, '');
                    }
                });
                codigoPlanillaInput.addEventListener('blur', () => {
                    if (!esExternaCheckbox.checked && codigoPlanillaInput.value && !/^1\d{7}$/.test(codigoPlanillaInput.value)) {
                        alert('El CÓDIGO DE PLANILLA para personal de Essalud debe ser de 8 dígitos y empezar con 1.');
                    }
                });
            }

            ['numeroDoc', 'telefono', 'telefonoIpress', 'colegiatura'].forEach(id => {
                const el = document.getElementById(id);
                if(el) el.addEventListener('input', function() { this.value = this.value.replace(/\D/g, ''); });
            });

            const correoInstInput = document.getElementById('correoInstitucional');
            if (correoInstInput) {
                correoInstInput.addEventListener('blur', function() {
                    const noCorreoCheckbox = document.getElementById('noCorreoInstitucional');
                    let valor = this.value.trim().toLowerCase();
                    if (!noCorreoCheckbox.checked && valor && !valor.includes('@')) {
                         this.value = valor + '@essalud.gob.pe';
                    }
                    this.dispatchEvent(new Event('input'));
                });
            }
            
            const correoPartInput = document.getElementById('correoParticular');
            if (correoPartInput) {
                correoPartInput.addEventListener('blur', function() { 
                    this.value = this.value.trim().toLowerCase(); 
                    this.dispatchEvent(new Event('input'));
                });
            }

            const videoModal = document.getElementById('video-modal');
            const openModalButton = document.getElementById('open-video-modal');
            const closeModalButton = document.getElementById('close-modal-button');

            const openModal = () => videoModal.style.display = 'flex';
            const closeModal = () => videoModal.style.display = 'none';

            openModalButton.addEventListener('click', openModal);
            closeModalButton.addEventListener('click', closeModal);
            videoModal.addEventListener('click', (event) => {
                if (event.target === videoModal) {
                    closeModal();
                }
            });

            const telefonoIpressInput = document.getElementById('telefonoIpress');
            if (telefonoIpressInput) {
                telefonoIpressInput.addEventListener('input', function() {
                    const formGroup = this.parentElement;
                    if (this.value.trim() !== '') {
                        formGroup.classList.add('is-valid-optional');
                    } else {
                        formGroup.classList.remove('is-valid-optional');
                    }
                });
            }
        });
    </script>
</body>
</html>












